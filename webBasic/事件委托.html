<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
	#tab {
		user-select: none;
		position: relative;
	}

    [class^='row-']:nth-child(odd) {
        background: #F9F9F9;
        /*background: #bbb;*/
    }

    [class^='row-']:nth-child(even) {
        background: #fff;
    }

    [class^='row-'] {
        height: 50px;
    }

	[class^='col-'] {
		border: 1px solid #ddd;
		width: 100px;
		height: 100%;
		display: inline-block;
		box-sizing: border-box;
	}

	#add-button {
		/*color: white;*/
		position: absolute;
		top: 10px;
		left: 0;
		border-radius: 20px;
		width: 30px;
		height: 30px;
		line-height: 30px;
		box-shadow: 1px 1px #ccc;
		border: none;
	}
	#add-button:focus {
		box-shadow: 1px 1px 1px #ccc inset;
		outline: none;
	}

	#add-model {
		background-color: #eee;
		height: 50px;
		position: absolute;
		display: none;
	}

	#add-input {
		box-sizing: border-box;
		text-align: center;
		width: 100%;
		height: 100%;
		margin: 0;
		padding: 0;
		display: none;
	}



    </style>
</head>

<body>
    <div id="tab">
        <div class="row-1">
        	<div class='col-1'></div
        	><div class='col-2'></div
        	><div class='col-3'></div>
        </div>
        <div class="row-2">
        	<div class='col-1'></div
        	><div class='col-2'></div
        	><div class='col-3'></div>
        </div>
        <div class="row-3">
        	<div class='col-1'></div
        	><div class='col-2'></div
        	><div class='col-3'></div>
        </div>
        <div class="row-4">
        	<div class='col-1'></div
        	><div class='col-2'></div
        	><div class='col-3'></div>
        </div>
        <div class="row-5">
        	<div class='col-1'></div
        	><div class='col-2'></div
        	><div class='col-3'></div>
        </div>
        <div class="row-6">
        	<div class='col-1'></div
        	><div class='col-2'></div
        	><div class='col-3'></div>
        </div>
        <div class="row-7">
        	<div class='col-1'></div
        	><div class='col-2'></div
        	><div class='col-3'></div>
        </div>
	</div>

	<div id="model-back">
		<div id="add-model">
	        <button id="add-button">+</button>
	        <input id="add-input" type="text" placeholder="请输入课程信息">
	    </div>
	</div>

    <script>
	const addBut = document.querySelector('#add-button')
	const addModel = document.querySelector('#add-model')
	const addInput = document.querySelector('#add-input')


    document.documentElement.onmousedown = function() {
    	addModel.style.display = 'none'
    	addInput.style.display = 'none';
    	addBut.style.display = 'block';
    }
    addModel.onmousedown = function(event) {
    	event.stopPropagation()
    }

    addBut.onclick = function() {
    	addInput.style.display = 'block'
    	addBut.style.display = 'none'
    }


    function addSelectEvent() {
    	let table = document.querySelector('#tab')
    	let select = {
    		selecting: false,
    		row: '',
    		colStart: '',
    		colOver: '',
    	}
    	table.onmousedown = function(event) {
    		if(event.target.className.match(/col/)) {	
	    		select.selecting = true
	    		select.row = event.target.parentElement.className.match(/\d/)[0]
	    		select.colStart = event.target.className.match(/\d/)[0]
    		}
    	}
    	table.onmouseup = function(event) {
    		if(select.selecting && select.row === event.target.parentElement.className.match(/\d/)[0]) {
    			select.colOver = event.target.className.match(/\d/)[0]
    			selectRender();
    		}
    		select.selecting = false
    	}

    	addInput.onkeyup = function(event) {
	    	if(event.key === 'Enter' && this.value) {
		    	addClass(this.value)
	    	}
	    }

	    function addClass(text) {
	    	console.log(select)
	    }

	    function selectRender() {
	    	let theRow = document.querySelector(`.row-${select.row}`)
	    	let cols = theRow.querySelectorAll(`[class^=col-]`)
	    	let start,over


	    	if(select.colStart < select.colOver) {
				start = select.colStart - 1
				over = select.colOver - 1
	    	}
	    	else {
				start = select.colOver - 1
				over = select.colStart - 1
	    	}

	    	for (let i = start; i <= over; i++) {
	    		// cols[i].style.background = '#CCC'
	    		// cols[i].dataset.selectd = true
	    		addModel.style.display = 'block'
	    		addBut.style.left = (over - start + 1)*50 - 15 + 'px'

	    		addModel.style.width = (over - start + 1) * 100 + 'px'
	    		addModel.style.top = table.offsetTop + 50*(select.row-1) + 'px'
	    		addModel.style.left = table.offsetLeft + 100 * start + 'px'
	    	}

    		console.log(`row: ${select.row}`)
    		console.log(`col1: ${select.colStart}`)
    		console.log(`col2: ${select.colOver}`)
	    }
    }


    addSelectEvent()

    </script>
</body>

</html>